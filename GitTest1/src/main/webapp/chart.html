<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>

<body>
    <!-- <input> -->
    
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@3.5.1/dist/chart.min.js"></script>
    <script type="text/javascript"
        src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.8.0/Chart.bundle.min.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.8.0/Chart.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <canvas id="myChart" width="400" height="400"></canvas>

    <script>
        // 차트를 그럴 영역을 dom요소로 가져온다.
        let data_nonIron = []
        //let page = document.querySelector('input')
        var chartArea = document.getElementById('myChart').getContext('2d');
        let all = []
        let totalEmissions = []
        let netEmissions = []
        // 차트를 생성한다. 

            $.ajax({
                // 1. 통신할 url
                url: "https://api.odcloud.kr/api/15049589/v1/uddi:779e44b1-25d9-48a8-bb63-8a90148adf9a?page=1&perPage=144&serviceKey=2dzr5Pgj1lthBgwtsb98tVqVqURheXyse3jsH2m7Zyp0JJxEXsduX39%2BqWsmKP8YJR30bUA2aHmq%2F3%2FL18m5CA%3D%3D",
                // 2. 통신 성공할 경우 로직
                success: function (result) {
                    //alert("통신 성공!!!")
                    console.log(result)
                    
                    data_nonIron = Object.keys(result.data[0])
                    //console.log(data_nonIron)
                    var myChart = new Chart(chartArea, {
                        // ①차트의 종류(String)
                        type: 'bar',
                        // ②차트의 데이터(Object)
                        data: {
                            // ③x축에 들어갈 이름들(Array)
                            labels: Object.keys(result.data[0]),
                            // ④실제 차트에 표시할 데이터들(Array), dataset객체들을 담고 있다.
                            datasets: [{
                                // ⑤dataset의 이름(String)
                                label: result.data[2]['분야 및 연도'],
                                // ⑥dataset값(Array)
                                data: Object.values(result.data[2]),
                                // ⑦dataset의 배경색(rgba값을 String으로 표현)
                                backgroundColor: ['rgba(255, 99, 132, 0.2)'],
                                // ⑧dataset의 선 색(rgba값을 String으로 표현)
                                borderColor: 'rgba(255, 99, 132, 1)',
                                // ⑨dataset의 선 두께(Number)
                                borderWidth: 5
                            }, {
                                label: result.data[37]['분야 및 연도'],
                                // ⑥dataset값(Array)
                                data: Object.values(result.data[37]),
                                // ⑦dataset의 배경색(rgba값을 String으로 표현)
                                backgroundColor: ['rgba(75, 192, 192, 0.2)'],
                                // ⑧dataset의 선 색(rgba값을 String으로 표현)
                                borderColor: 'rgba(75, 192, 192, 1)',
                                // ⑨dataset의 선 두께(Number)
                                borderWidth: 5
                            }, {
                                label: result.data[65]['분야 및 연도'],
                                // ⑥dataset값(Array)
                                data: Object.values(result.data[65]),
                                // ⑦dataset의 배경색(rgba값을 String으로 표현)
                                backgroundColor: ['rgba(255, 99, 132, 0.2)'],
                                // ⑧dataset의 선 색(rgba값을 String으로 표현)
                                borderColor: 'rgba(255, 99, 132, 1)',
                                // ⑨dataset의 선 두께(Number)
                                borderWidth: 5
                            }, {
                                label: result.data[102]['분야 및 연도'],
                                // ⑥dataset값(Array)
                                data: Object.values(result.data[102]),
                                // ⑦dataset의 배경색(rgba값을 String으로 표현)
                                backgroundColor: ['rgba(255, 205, 86, 0.2)'],
                                // ⑧dataset의 선 색(rgba값을 String으로 표현)
                                borderColor: 'rgba(255, 205, 86, 1)',
                                // ⑨dataset의 선 두께(Number)
                                borderWidth: 5
                            }, {
                                label: result.data[129]['분야 및 연도'],
                                // ⑥dataset값(Array)
                                data: Object.values(result.data[129]),
                                // ⑦dataset의 배경색(rgba값을 String으로 표현)
                                backgroundColor: ['rgba(75, 192, 192, 0.2)'],
                                // ⑧dataset의 선 색(rgba값을 String으로 표현)
                                borderColor: 'rgba(75, 192, 192, 1)',
                                // ⑨dataset의 선 두께(Number)
                                borderWidth: 5
                            }, {
                                type: 'line',
                                label: result.data[1]['분야 및 연도'],
                                // ⑥dataset값(Array)
                                data: Object.values(result.data[0]),
                                // ⑦dataset의 배경색(rgba값을 String으로 표현)
                                backgroundColor: ['rgba(75, 192, 192, 0.2)'],
                                // ⑧dataset의 선 색(rgba값을 String으로 표현)
                                borderColor: 'rgba(75, 192, 192, 1)',
                                // ⑨dataset의 선 두께(Number)
                                borderWidth: 1
                            }

                            ]

                        },
                        // ⑩차트의 설정(Object)
                        options: {
                            //grouped: false,
                            responsive: false,
                            // ⑪축에 관한 설정(Object)
                            scales: {
                                // ⑫y축에 대한 설정(Object)
                                x: {
                                    stacked : true
                                },
                                y: {
                                    stacked : true,
                                    // ⑬시작을 0부터 하게끔 설정(최소값이 0보다 크더라도)(boolean)
                                    beginAtZero: true
                                }
                            },
                            legend: {
                                display : false
                            }
                        }
                    });

                },
                // 3. 통신 실패할 경우 로직
                error: function () {
                    alert("통신 실패...")
                }
            })

            console.log(all)
        

    </script>
</body>

</html>